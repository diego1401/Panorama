<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>Imagine++: LinAlg/test/test.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Imagine++
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">LinAlg/test/test.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">// ===========================================================================</span></div>
<div class="line"><span class="comment">// Imagine++ Libraries</span></div>
<div class="line"><span class="comment">// Copyright (C) Imagine</span></div>
<div class="line"><span class="comment">// For detailed information: http://imagine.enpc.fr/software</span></div>
<div class="line"><span class="comment">// ===========================================================================</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// So far, this file is aimed at using each function at least once.</span></div>
<div class="line"><span class="comment">// Hence, it is provided more as a test for compilation than as a true example...</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;Imagine/Common.h&gt;</span>     </div>
<div class="line"><span class="preprocessor">#include &lt;Imagine/LinAlg.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="namespace_imagine.html">Imagine</a>;</div>
<div class="line"><span class="keyword">using namespace </span>std;</div>
<div class="line"></div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><span class="keywordtype">void</span> vectors() {</div>
<div class="line">    <span class="comment">// NB: Plus all functions of Array class!</span></div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Vector functions&quot;</span> &lt;&lt; endl;</div>
<div class="line">    <a name="_a0"></a><a class="code" href="class_imagine_1_1_vector.html">Vector&lt;T&gt;</a> a;                     <span class="comment">// non allocated</span></div>
<div class="line">    <a class="code" href="class_imagine_1_1_vector.html">Vector&lt;T&gt;</a> b(4);                  <span class="comment">// allocated with specified size</span></div>
<div class="line">    T t[]={1,2,3};                   <span class="comment">// pre-allocated</span></div>
<div class="line">    <a class="code" href="class_imagine_1_1_vector.html">Vector&lt;T&gt;</a> e(t,3);</div>
<div class="line">    T *t2=<span class="keyword">new</span> T[3];</div>
<div class="line">    <a class="code" href="class_imagine_1_1_vector.html">Vector&lt;T&gt;</a> e2(t2,3,<span class="keyword">true</span>);         <span class="comment">// ...</span></div>
<div class="line">    <a class="code" href="class_imagine_1_1_vector.html">Vector&lt;T&gt;</a> c(b);                  <span class="comment">// copy constructor</span></div>
<div class="line">    b=<a name="a1"></a><a class="code" href="class_imagine_1_1_vector.html#aa7036a6a92d9d21771bdc08ae2328834">Vector&lt;T&gt;::Zero</a>(4);            <span class="comment">// Vector with constant 0 value</span></div>
<div class="line">    b.<a name="a2"></a><a class="code" href="class_imagine_1_1_vector.html#a3a3fd7f0fcb9a43bf0b3291024116991">fill</a>(1.);                      <span class="comment">// filling with constant value</span></div>
<div class="line">    c=b;                             <span class="comment">// assignment</span></div>
<div class="line">    a=b.<a name="a3"></a><a class="code" href="class_imagine_1_1_vector.html#a9c6794ea04f44e8187c76906eb821cdd">clone</a>();                     <span class="comment">// cloning (fresh memory)</span></div>
<div class="line">    c=b.<a name="a4"></a><a class="code" href="class_imagine_1_1_vector.html#a69d0f0826cf10131139f33d690f173cf">getSubVect</a>(1,2);             <span class="comment">// sub vector</span></div>
<div class="line">    c=b.<a name="a5"></a><a class="code" href="class_imagine_1_1_vector.html#a88b3190785b6c7b36068b0db452f4175">getSubVectRef</a>(1,2);          <span class="comment">// sub vector ref (beware of restrictions!)</span></div>
<div class="line">    c=a+b;                           <span class="comment">// +</span></div>
<div class="line">    c+=b;                            <span class="comment">// +=</span></div>
<div class="line">    c=a-b;                           <span class="comment">// -</span></div>
<div class="line">    c-=b;                            <span class="comment">// -=</span></div>
<div class="line">    c=a+1;                           <span class="comment">// + scalar</span></div>
<div class="line">    c+=1;                            <span class="comment">// += scalar</span></div>
<div class="line">    c=a-1;                           <span class="comment">// - scalar</span></div>
<div class="line">    c-=1;                            <span class="comment">// -= scalar</span></div>
<div class="line">    c=-a;                            <span class="comment">// unary -</span></div>
<div class="line">    c=a*2;                           <span class="comment">// * scalar </span></div>
<div class="line">    c*=2;                            <span class="comment">// *= scalar </span></div>
<div class="line">    c=a/2;                           <span class="comment">// / scalar </span></div>
<div class="line">    c/=2;                            <span class="comment">// /= scalar </span></div>
<div class="line">    c=1+a;                           <span class="comment">// scalar + Vector</span></div>
<div class="line">    c=1-a;                           <span class="comment">// scalar - Vector</span></div>
<div class="line">    c=2*a;                           <span class="comment">// scalar * Vector</span></div>
<div class="line">    T x;</div>
<div class="line">    x=a*b;                           <span class="comment">// scalar product</span></div>
<div class="line">    x=norm2(a);                      <span class="comment">// squared Euclidean norm</span></div>
<div class="line">    x=norm(a);                       <span class="comment">// Euclidean norm</span></div>
<div class="line">    c.<a name="a6"></a><a class="code" href="class_imagine_1_1_vector.html#ae92c094ada77ec97efd55801833bf7fc">normalize</a>();                   <span class="comment">// Euclidean in-place normalization</span></div>
<div class="line">    c=normalized(a);                 <span class="comment">// Euclidean normalization</span></div>
<div class="line">    x=maxNorm(a);                    <span class="comment">// Maximum norm</span></div>
<div class="line">    x=sum(a);                        <span class="comment">// sum of values</span></div>
<div class="line">    x=mean(a);                       <span class="comment">// mean of values</span></div>
<div class="line">    <a class="code" href="class_imagine_1_1_vector.html">Vector&lt;T&gt;</a> K(2);</div>
<div class="line">    K.<a class="code" href="class_imagine_1_1_vector.html#a3a3fd7f0fcb9a43bf0b3291024116991">fill</a>(1);</div>
<div class="line">    c=convolution(K,a);              <span class="comment">// Full Convolution </span></div>
<div class="line">    c=truncConvolution(K,a,1);       <span class="comment">// Truncated convolution</span></div>
<div class="line">    <a class="code" href="class_imagine_1_1_vector.html">Vector&lt;T&gt;</a> v1(4),v2(4);</div>
<div class="line">    v1.fill(1);v2.<a class="code" href="class_imagine_1_1_vector.html#a3a3fd7f0fcb9a43bf0b3291024116991">fill</a>(2);</div>
<div class="line">    <a name="_a7"></a><a class="code" href="class_imagine_1_1_matrix.html">Matrix&lt;T&gt;</a> O=<a name="a8"></a><a class="code" href="group___lin_alg.html#gabe0415918398e13badce024d3eda70d5">outerProduct</a>(v1,v2); <span class="comment">// outer product</span></div>
<div class="line">    a[1]=2;b[2]=2;</div>
<div class="line">    x=correlation(a,b);              <span class="comment">// correlation</span></div>
<div class="line">    x=normalizedCorrelation(a,b);    <span class="comment">// normalized correlation</span></div>
<div class="line">    <span class="keywordtype">double</span> y=dist(a,b);              <span class="comment">// distance*/</span></div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><span class="keywordtype">void</span> matrices() {</div>
<div class="line">    <span class="comment">// NB: Plus all functions of MultiArray class!</span></div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Matrix functions&quot;</span> &lt;&lt; endl;</div>
<div class="line">    <a class="code" href="class_imagine_1_1_matrix.html">Matrix&lt;T&gt;</a> A;                         <span class="comment">// non allocated</span></div>
<div class="line">    <a class="code" href="class_imagine_1_1_matrix.html">Matrix&lt;T&gt;</a> B(3,4);                    <span class="comment">// allocated with specified size</span></div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;3; i++)</div>
<div class="line">        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;4; j++)</div>
<div class="line">            B(i,j)=rand()/(T)RAND_MAX;</div>
<div class="line">    T tt[]={1,2,3,4,5,6};                <span class="comment">// pre-allocated</span></div>
<div class="line">    <a class="code" href="class_imagine_1_1_matrix.html">Matrix&lt;T&gt;</a> D(tt,3,2);        </div>
<div class="line">    T *tt2=<span class="keyword">new</span> T[6];</div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;6; i++)</div>
<div class="line">        tt2[i]=rand()/(T)RAND_MAX;</div>
<div class="line">    <a class="code" href="class_imagine_1_1_matrix.html">Matrix&lt;T&gt;</a> D2(tt2,3,2,<span class="keyword">true</span>);          <span class="comment">// ...</span></div>
<div class="line">    <a class="code" href="class_imagine_1_1_matrix.html">Matrix&lt;T&gt;</a> C(B);                      <span class="comment">// copy constructor</span></div>
<div class="line">    A=B;                                 <span class="comment">// assignment</span></div>
<div class="line">    A=B.<a name="a9"></a><a class="code" href="class_imagine_1_1_matrix.html#a11f755ad050f82527d605601658fb00d">clone</a>();                         <span class="comment">// cloning (fresh memory)</span></div>
<div class="line">    <span class="keywordtype">int</span> m=A.<a name="a10"></a><a class="code" href="class_imagine_1_1_matrix.html#ae7c61828c235104c8ba0fb888b52b30f">nrow</a>(),n=A.<a name="a11"></a><a class="code" href="class_imagine_1_1_matrix.html#a935d2e6f1eb2bdacebac953aea315b1a">ncol</a>();           <span class="comment">// Dimensions</span></div>
<div class="line">    A=<a name="a12"></a><a class="code" href="class_imagine_1_1_matrix.html#a882be1e45b1442eb65b86c53dbc47cb0">Matrix&lt;T&gt;::Zero</a>(3,4);              <span class="comment">// Matrix with constant 0 value</span></div>
<div class="line">    A.<a name="a13"></a><a class="code" href="class_imagine_1_1_matrix.html#a1ba0cd2a6fa43d69db93a1327e6ce173">fill</a>(1);                           <span class="comment">// filling with constant value</span></div>
<div class="line">    <a class="code" href="class_imagine_1_1_matrix.html">Matrix&lt;T&gt;</a> I=<a name="a14"></a><a class="code" href="class_imagine_1_1_matrix.html#a463f227c99d37e6a1df9426dfc778df0">Matrix&lt;T&gt;::Identity</a>(4);  <span class="comment">// Identity</span></div>
<div class="line">    <a class="code" href="class_imagine_1_1_vector.html">Vector&lt;T&gt;</a> d(tt,6);                   <span class="comment">// diagonal</span></div>
<div class="line">    B=<a name="a15"></a><a class="code" href="group___common.html#ga62a53c231a09e755f7317b515f968afb">Diagonal</a>(d);                       <span class="comment">// ...</span></div>
<div class="line">    A(1,2)=3;</div>
<div class="line">    <a class="code" href="class_imagine_1_1_vector.html">Vector&lt;T&gt;</a> v,w;</div>
<div class="line">    v=A.<a name="a16"></a><a class="code" href="class_imagine_1_1_matrix.html#a2bb75c2e95862e6542bb510ea68becce">getCol</a>(2);                       <span class="comment">// Get column</span></div>
<div class="line">    A.<a name="a17"></a><a class="code" href="class_imagine_1_1_matrix.html#afa2b9d8f204960fb8b3bf0b62d27e0a1">setCol</a>(1,v);                       <span class="comment">// Set column</span></div>
<div class="line">    v=A.<a name="a18"></a><a class="code" href="class_imagine_1_1_matrix.html#a71a4b8c27e09a74b1f85cce39c299089">getRow</a>(1);                       <span class="comment">// Get row</span></div>
<div class="line">    A.<a name="a19"></a><a class="code" href="class_imagine_1_1_matrix.html#a4d888933b63240f3c24e149f70d0b90f">setRow</a>(2,v);                       <span class="comment">// Set row</span></div>
<div class="line">    v=A.<a name="a20"></a><a class="code" href="class_imagine_1_1_matrix.html#a35e57d5e2058d60f85618d95fc3d81c5">getDiagonal</a>();                   <span class="comment">// Get diagonal</span></div>
<div class="line">    A.<a name="a21"></a><a class="code" href="class_imagine_1_1_matrix.html#aad225fa44e98b36bda59d327c1abc34d">setDiagonal</a>(v);                    <span class="comment">// Set diagonal</span></div>
<div class="line">    v=A.<a name="a22"></a><a class="code" href="class_imagine_1_1_matrix.html#a087a98d8af27d9b9a40ed5f2478bfd85">getColRef</a>(2);                    <span class="comment">// Vector pointing to column (beware of restrictions!)</span></div>
<div class="line">    v=A.<a name="a23"></a><a class="code" href="class_imagine_1_1_matrix.html#adcbf93660b6b33c1916ce8e9887c1fa2">getSubColRef</a>(2,1,2);             <span class="comment">// Vector pointing to sub-column (beware of restrictions!)</span></div>
<div class="line">    B=A.<a name="a24"></a><a class="code" href="class_imagine_1_1_matrix.html#ad2afb9f14e9cbec4ce38eab32ebdf26d">getSubMat</a>(1,2,1,2);              <span class="comment">// Get sub matrix</span></div>
<div class="line">    B=A.<a name="a25"></a><a class="code" href="class_imagine_1_1_matrix.html#af73efe781fcece155e25414d970d85ba">getColsRef</a>(1,2);                 <span class="comment">// Matrix pointing to part of columns (beware of restrictions!)</span></div>
<div class="line">    v=<a class="code" href="class_imagine_1_1_vector.html">Vector&lt;T&gt;</a>(4).fill(1);</div>
<div class="line">    w=A*v;                               <span class="comment">// matrix * vector</span></div>
<div class="line">    v=<a name="a26"></a><a class="code" href="group___common.html#gaaf3d7cd34a0c491d390afd4246090be3">tmult</a>(A,w);                        <span class="comment">// matrix^T * vector</span></div>
<div class="line">    A=A*<a name="a27"></a><a class="code" href="group___common.html#ga7a6f4637021ea46668612c558b8ace96">transpose</a>(A);                    <span class="comment">// transpose</span></div>
<div class="line">    A(1,2)=2;</div>
<div class="line">    B=<a name="a28"></a><a class="code" href="group___common.html#ga4554c90f5b26a44818b544096b5b3c23">inverse</a>(A);                        <span class="comment">// inverse</span></div>
<div class="line">    <a class="code" href="class_imagine_1_1_matrix.html">Matrix&lt;T&gt;</a>A32(3,2); A32.fill(1.);</div>
<div class="line">    <a class="code" href="class_imagine_1_1_matrix.html">Matrix&lt;T&gt;</a>A23(2,3); A23.fill(1.);</div>
<div class="line">    <a class="code" href="class_imagine_1_1_matrix.html">Matrix&lt;T&gt;</a>A24(2,4); A24.fill(1.);</div>
<div class="line">    <a class="code" href="class_imagine_1_1_matrix.html">Matrix&lt;T&gt;</a>A42(4,2); A42.fill(1.);</div>
<div class="line">    <a class="code" href="class_imagine_1_1_matrix.html">Matrix&lt;T&gt;</a> A34;</div>
<div class="line">    A34=A32*A24;                         <span class="comment">// matrix * matrix</span></div>
<div class="line">    A34=<a class="code" href="group___common.html#gaaf3d7cd34a0c491d390afd4246090be3">tmult</a>(A23,A24);                  <span class="comment">// matrix^T * matrix</span></div>
<div class="line">    A34=<a name="a29"></a><a class="code" href="group___common.html#ga72940a5acd67542a4e04c93a112a4874">multt</a>(A32,A42);                  <span class="comment">// matrix * matrix^T</span></div>
<div class="line">    A34=<a name="a30"></a><a class="code" href="group___common.html#ga6ae42e84be61acd021331b32bf87fc40">tmultt</a>(A23,A42);                 <span class="comment">// matrix^T * matrix^T</span></div>
<div class="line">    C=A+B;                               <span class="comment">// +</span></div>
<div class="line">    C+=B;                                <span class="comment">// +=</span></div>
<div class="line">    C=A-B;                               <span class="comment">// -</span></div>
<div class="line">    C-=B;                                <span class="comment">// -=</span></div>
<div class="line">    C=-A;                                <span class="comment">// unary -</span></div>
<div class="line">    C=A*2;                               <span class="comment">// * scalar </span></div>
<div class="line">    C*=2;                                <span class="comment">// *= scalar </span></div>
<div class="line">    C=A/2;                               <span class="comment">// / scalar </span></div>
<div class="line">    C/=2;                                <span class="comment">// /= scalar </span></div>
<div class="line">    C=2*A;                               <span class="comment">// scalar * Matrix</span></div>
<div class="line">    T a;</div>
<div class="line">    a=dot(A,C);                          <span class="comment">// scalar product</span></div>
<div class="line">    a=norm(A);                           <span class="comment">// frobenius norm</span></div>
<div class="line">    a=norm(A,<span class="charliteral">&#39;1&#39;</span>);                       <span class="comment">// 1-norm</span></div>
<div class="line">    a=norm(A,<span class="charliteral">&#39;I&#39;</span>);                       <span class="comment">// infinity-norm</span></div>
<div class="line">    a=norm(A,<span class="charliteral">&#39;M&#39;</span>);                       <span class="comment">// max norm...</span></div>
<div class="line">    a=rcond(A);                          <span class="comment">// reciprocal condition number</span></div>
<div class="line"></div>
<div class="line">    <a class="code" href="class_imagine_1_1_vector.html">Vector&lt;T&gt;</a> S;                         <span class="comment">// Singular value decomposition</span></div>
<div class="line">    <a class="code" href="class_imagine_1_1_matrix.html">Matrix&lt;T&gt;</a> U,Vt;</div>
<div class="line">    <a name="a31"></a><a class="code" href="group___lin_alg.html#gac422594d6d9d59381c93765d1c935d8e">svd</a>(A,U,S,Vt);                           <span class="comment">// square matrix</span></div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;SVD check 1: &quot;</span> </div>
<div class="line">        &lt;&lt; norm(A-U*<a class="code" href="group___common.html#ga62a53c231a09e755f7317b515f968afb">Diagonal</a>(S)*Vt) &lt;&lt; endl; <span class="comment">// Check result</span></div>
<div class="line">    <a class="code" href="group___lin_alg.html#gac422594d6d9d59381c93765d1c935d8e">svd</a>(A34,U,S,Vt);                         <span class="comment">// non square matrix</span></div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;SVD check 2: &quot;</span> </div>
<div class="line">         &lt;&lt; norm(A34-U*<a class="code" href="class_imagine_1_1_matrix.html">Matrix&lt;T&gt;::Zero</a>(3,4).setDiagonal(S)*Vt) &lt;&lt; endl; <span class="comment">// Check result</span></div>
<div class="line">    <a class="code" href="group___lin_alg.html#gac422594d6d9d59381c93765d1c935d8e">svd</a>(A34,U,S,Vt,<span class="keyword">true</span>);                    <span class="comment">// non square, complete U and Vt</span></div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;SVD check 3: &quot;</span> </div>
<div class="line">        &lt;&lt; norm(Vt*<a class="code" href="group___common.html#ga7a6f4637021ea46668612c558b8ace96">transpose</a>(Vt)-<a class="code" href="class_imagine_1_1_matrix.html">Matrix&lt;T&gt;::Identity</a>(4)) &lt;&lt; endl; <span class="comment">// Check Vt...</span></div>
<div class="line">    </div>
<div class="line">    <a name="a32"></a><a class="code" href="group___common.html#ga22e8edb30a8e0e013e8fe06a26a729e0">initRandom</a>(1);                                             <span class="comment">// Linear solve</span></div>
<div class="line">    A.<a name="a33"></a><a class="code" href="class_imagine_1_1_multi_array.html#a3d141148cc2ada24c73ee4fab561d2c9">setSize</a>(5,5);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;5;i++)</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;5;j++)</div>
<div class="line">            A(i,j)=T(<a name="a34"></a><a class="code" href="group___common.html#ga9266b3e5117d08c4b45e60bb7c240b40">doubleRandom</a>());</div>
<div class="line">    <a class="code" href="class_imagine_1_1_vector.html">Vector&lt;T&gt;</a> b(5),x;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;5;j++)</div>
<div class="line">            b[j]=T(<a class="code" href="group___common.html#ga9266b3e5117d08c4b45e60bb7c240b40">doubleRandom</a>());</div>
<div class="line"></div>
<div class="line">    x=<a name="a35"></a><a class="code" href="group___lin_alg.html#ga067f853c4d1c272d7222d624e8776c2a">linSolve</a>(A,b);</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Square system: &quot;</span> &lt;&lt; norm(A*x-b) &lt;&lt; endl;          <span class="comment">// Check</span></div>
<div class="line">    C=A.<a class="code" href="class_imagine_1_1_matrix.html#ad2afb9f14e9cbec4ce38eab32ebdf26d">getSubMat</a>(0,5,0,4); </div>
<div class="line">    x=<a class="code" href="group___lin_alg.html#ga067f853c4d1c272d7222d624e8776c2a">linSolve</a>(C,b);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Over determined system: &quot;</span> &lt;&lt; norm(C*x-b) &lt;&lt; endl; <span class="comment">// Check (min possible but not 0)</span></div>
<div class="line">    C=A.<a class="code" href="class_imagine_1_1_matrix.html#ad2afb9f14e9cbec4ce38eab32ebdf26d">getSubMat</a>(0,4,0,5);</div>
<div class="line">    x=<a class="code" href="group___lin_alg.html#ga067f853c4d1c272d7222d624e8776c2a">linSolve</a>(C,b.getSubVect(0,4));</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Minimum norm under determined system: &quot;</span> </div>
<div class="line">        &lt;&lt; norm(C*x-b.<a class="code" href="class_imagine_1_1_vector.html#a69d0f0826cf10131139f33d690f173cf">getSubVect</a>(0,4)) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; norm(x) &lt;&lt; endl; <span class="comment">// Check (min |x| possible but not 0)...</span></div>
<div class="line"></div>
<div class="line">    x=<a name="a36"></a><a class="code" href="group___lin_alg.html#ga0f5fb1fa3fbd6d7cc7988f2e0f87bf99">pseudoInverse</a>(A)*b;                                      <span class="comment">// pseudo-inverse</span></div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Pseudo inverse, square: &quot;</span> &lt;&lt; norm(A*x-b) &lt;&lt; endl; <span class="comment">// Check it, square case</span></div>
<div class="line">    C=A.<a class="code" href="class_imagine_1_1_matrix.html#ad2afb9f14e9cbec4ce38eab32ebdf26d">getSubMat</a>(0,5,0,4); </div>
<div class="line">    x=<a class="code" href="group___lin_alg.html#ga0f5fb1fa3fbd6d7cc7988f2e0f87bf99">pseudoInverse</a>(C)*b;</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Pseudo inverse, over determined: &quot;</span> &lt;&lt; norm(C*x-b) &lt;&lt; endl; <span class="comment">// Check it, over determined case</span></div>
<div class="line">    C=A.<a class="code" href="class_imagine_1_1_matrix.html#ad2afb9f14e9cbec4ce38eab32ebdf26d">getSubMat</a>(0,4,0,5);</div>
<div class="line">    x=<a class="code" href="group___lin_alg.html#ga0f5fb1fa3fbd6d7cc7988f2e0f87bf99">pseudoInverse</a>(C)*b.getSubVect(0,4);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Pseudo inverse, under determined: &quot;</span> </div>
<div class="line">        &lt;&lt; norm(C*x-b.<a class="code" href="class_imagine_1_1_vector.html#a69d0f0826cf10131139f33d690f173cf">getSubVect</a>(0,4)) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; norm(x) &lt;&lt; endl;       <span class="comment">// Check it, under determined case...</span></div>
<div class="line"></div>
<div class="line">    <a class="code" href="class_imagine_1_1_matrix.html">Matrix&lt;T&gt;</a> Q,R;                        <span class="comment">// QR decomposition</span></div>
<div class="line">    <a name="a37"></a><a class="code" href="group___lin_alg.html#gab21f09665e8f0a0244f45fb10bf7726e">QR</a>(D,Q,R);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;QR &quot;</span> &lt;&lt; norm(D-Q*R) &lt;&lt; endl; <span class="comment">// check thin QR</span></div>
<div class="line">    <a class="code" href="group___lin_alg.html#gab21f09665e8f0a0244f45fb10bf7726e">QR</a>(D,Q,R,<span class="keyword">true</span>);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;QR &quot;</span> &lt;&lt; norm(D-Q*R) &lt;&lt; endl; <span class="comment">// check full QR...</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line">    B=A*<a class="code" href="group___common.html#ga7a6f4637021ea46668612c558b8ace96">transpose</a>(A);   <span class="comment">//symmetric positive-definite</span></div>
<div class="line">    <a class="code" href="class_imagine_1_1_matrix.html">Matrix&lt;T&gt;</a> L=<a name="a38"></a><a class="code" href="group___lin_alg.html#ga972b982abc4e29e50c6551578bf2b440">cholesky</a>(B);                                     <span class="comment">// Cholesky decomposition</span></div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Lower Cholesky &quot;</span> &lt;&lt; norm(B-L*<a class="code" href="group___common.html#ga7a6f4637021ea46668612c558b8ace96">transpose</a>(L)) &lt;&lt; endl; <span class="comment">// Check lower</span></div>
<div class="line">    U=<a class="code" href="group___lin_alg.html#ga972b982abc4e29e50c6551578bf2b440">cholesky</a>(B,<span class="keyword">false</span>);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Upper Cholesky &quot;</span> &lt;&lt; norm(B-<a class="code" href="group___common.html#ga7a6f4637021ea46668612c558b8ace96">transpose</a>(U)*U) &lt;&lt; endl; <span class="comment">// Check upper...</span></div>
<div class="line"></div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;A=&quot;</span> &lt;&lt; A &lt;&lt; endl;</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Det: &quot;</span> &lt;&lt; <a name="a39"></a><a class="code" href="group___common.html#ga35068ca7329c1ea584d1f2174eaac4c6">det</a>(A) &lt;&lt; endl;</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Determinants: &quot;</span> &lt;&lt; <a class="code" href="group___common.html#ga35068ca7329c1ea584d1f2174eaac4c6">det</a>(A)*<a class="code" href="group___common.html#ga35068ca7329c1ea584d1f2174eaac4c6">det</a>(<a class="code" href="group___common.html#ga4554c90f5b26a44818b544096b5b3c23">inverse</a>(A))-1 &lt;&lt; endl;<span class="comment">// Determinant</span></div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Determinants: &quot;</span> &lt;&lt; <a class="code" href="group___common.html#ga35068ca7329c1ea584d1f2174eaac4c6">det</a>(B)*<a class="code" href="group___common.html#ga35068ca7329c1ea584d1f2174eaac4c6">det</a>(<a class="code" href="group___common.html#ga4554c90f5b26a44818b544096b5b3c23">inverse</a>(B))-1 &lt;&lt; endl;<span class="comment">// Check sym pos-def acceleration...</span></div>
<div class="line"></div>
<div class="line">    ofstream out(<span class="stringliteral">&quot;tmp.txt&quot;</span>); <span class="comment">// ASCII write</span></div>
<div class="line">    out &lt;&lt; A &lt;&lt; endl;        <span class="comment">// ...</span></div>
<div class="line">    out.close();</div>
<div class="line">    ifstream in(<span class="stringliteral">&quot;tmp.txt&quot;</span>);  <span class="comment">// ASCII read</span></div>
<div class="line">    in &gt;&gt; A;                 <span class="comment">// ...</span></div>
<div class="line">    in.close(); </div>
<div class="line"></div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><span class="keywordtype">void</span> symMatrices() {</div>
<div class="line">    <span class="comment">// NB: Plus all functions of Array class!</span></div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;SymMatrix functions&quot;</span> &lt;&lt; endl;</div>
<div class="line">    <a name="_a40"></a><a class="code" href="singleton_imagine_1_1_sym_matrix.html">SymMatrix&lt;T&gt;</a> A;                     <span class="comment">// non allocated</span></div>
<div class="line">    <a class="code" href="singleton_imagine_1_1_sym_matrix.html">SymMatrix&lt;T&gt;</a> B(10);                 <span class="comment">// allocated with specified size</span></div>
<div class="line">    <a class="code" href="singleton_imagine_1_1_sym_matrix.html">SymMatrix&lt;T&gt;</a> C(B);                  <span class="comment">// copy constructor</span></div>
<div class="line">    T t[]={1,2,3,4,5};                  <span class="comment">// pre-allocated</span></div>
<div class="line">    <a class="code" href="singleton_imagine_1_1_sym_matrix.html">SymMatrix&lt;T&gt;</a> D(t,3);</div>
<div class="line">    T *t2=<span class="keyword">new</span> T[5];</div>
<div class="line">    <a class="code" href="singleton_imagine_1_1_sym_matrix.html">SymMatrix&lt;T&gt;</a> D2(t2,3,<span class="keyword">true</span>);         <span class="comment">// ...</span></div>
<div class="line">    <a class="code" href="class_imagine_1_1_matrix.html">Matrix&lt;T&gt;</a> E(4,4);</div>
<div class="line">    <a class="code" href="singleton_imagine_1_1_sym_matrix.html">SymMatrix&lt;T&gt;</a> F(E);                  <span class="comment">// conversion Matrix -&gt; SymMatrix</span></div>
<div class="line">    F=B;                                <span class="comment">// assignment</span></div>
<div class="line">    F=B.clone();                        <span class="comment">// cloning (fresh memory)</span></div>
<div class="line">    F.setSize(5);                       <span class="comment">// setSize</span></div>
<div class="line">    <span class="keywordtype">int</span> nr=F.nrow(),nc=F.ncol();        <span class="comment">// numbers of rows and columns (both equal to specified size!)</span></div>
<div class="line">    F.fill(2);                          <span class="comment">// filling with constant value</span></div>
<div class="line">    F=<a name="a41"></a><a class="code" href="singleton_imagine_1_1_sym_matrix.html#ad132d30898cd782fd9f81ed4a3a1db16">SymMatrix&lt;T&gt;::Zero</a>(5);            <span class="comment">// Matrix with constant 0 value</span></div>
<div class="line">    F=<a name="a42"></a><a class="code" href="singleton_imagine_1_1_sym_matrix.html#a5e247539c648765b627b913dba6ca172">SymMatrix&lt;T&gt;::Identity</a>(5);        <span class="comment">// Identity</span></div>
<div class="line">    T a=F(2,2);                         <span class="comment">// read access</span></div>
<div class="line">    F(2,3)=a;                           <span class="comment">// write access</span></div>
<div class="line">    <a class="code" href="class_imagine_1_1_matrix.html">Matrix&lt;T&gt;</a> G=F.<a name="a43"></a><a class="code" href="class_imagine_1_1_matrix.html#ad2afb9f14e9cbec4ce38eab32ebdf26d">getSubMat</a>(1,3,0,4);   <span class="comment">// Get sub matrix</span></div>
<div class="line">    <a class="code" href="class_imagine_1_1_vector.html">Vector&lt;T&gt;</a> d=F.getDiagonal();        <span class="comment">// Get diagonal</span></div>
<div class="line">    F.<a name="a44"></a><a class="code" href="class_imagine_1_1_vector.html#a3a3fd7f0fcb9a43bf0b3291024116991">fill</a>(1);F(0,0)=2;F(0,1)=3;F(1,2)=2;F(2,3)=4;F(3,4)=-1;</div>
<div class="line">    <a class="code" href="class_imagine_1_1_vector.html">Vector&lt;T&gt;</a> v1=<a class="code" href="class_imagine_1_1_vector.html">Vector&lt;T&gt;</a>(5).fill(2);</div>
<div class="line">    <a class="code" href="class_imagine_1_1_vector.html">Vector&lt;T&gt;</a> v2=F*v1;                  <span class="comment">// matrix * vector</span></div>
<div class="line">    <a class="code" href="singleton_imagine_1_1_sym_matrix.html">SymMatrix&lt;T&gt;</a> invF=<a class="code" href="group___common.html#ga4554c90f5b26a44818b544096b5b3c23">inverse</a>(F);                                <span class="comment">// inverse</span></div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Inverse: &quot;</span> &lt;&lt; norm(F*invF-<a class="code" href="class_imagine_1_1_matrix.html">Matrix&lt;T&gt;::Identity</a>(5)) &lt;&lt; endl;<span class="comment">// ...</span></div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Determinant: &quot;</span> &lt;&lt; <a class="code" href="group___common.html#ga35068ca7329c1ea584d1f2174eaac4c6">det</a>(F)*<a class="code" href="group___common.html#ga35068ca7329c1ea584d1f2174eaac4c6">det</a>(invF)-1 &lt;&lt; endl;       <span class="comment">// determinant</span></div>
<div class="line">    <a class="code" href="class_imagine_1_1_matrix.html">Matrix&lt;T&gt;</a> Q;                                                 <span class="comment">// Eigen values</span></div>
<div class="line">    <a class="code" href="class_imagine_1_1_vector.html">Vector&lt;T&gt;</a> Lambda;</div>
<div class="line">    EVD(F,Q,Lambda);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Check EVD: &quot;</span></div>
<div class="line">        &lt;&lt; norm(Q*<a class="code" href="group___common.html#ga7a6f4637021ea46668612c558b8ace96">transpose</a>(Q)- <a class="code" href="class_imagine_1_1_matrix.html">Matrix&lt;T&gt;::Identity</a>(5)) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">        &lt;&lt; norm(Q*<a class="code" href="group___common.html#ga62a53c231a09e755f7317b515f968afb">Diagonal</a>(Lambda)*<a class="code" href="group___common.html#ga7a6f4637021ea46668612c558b8ace96">transpose</a>(Q)-F) &lt;&lt; endl;      <span class="comment">// ...</span></div>
<div class="line">    </div>
<div class="line">    F=F*F;</div>
<div class="line">    invF=posDefInverse(F);                          <span class="comment">// positive-definite inverse</span></div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Inverse: &quot;</span> &lt;&lt; norm(F*invF-<a class="code" href="class_imagine_1_1_matrix.html">Matrix&lt;T&gt;::Identity</a>(5)) &lt;&lt; endl; <span class="comment">// ...</span></div>
<div class="line">    </div>
<div class="line">    G.<a class="code" href="class_imagine_1_1_multi_array.html#a3d141148cc2ada24c73ee4fab561d2c9">setSize</a>(5);</div>
<div class="line">    G.<a class="code" href="class_imagine_1_1_matrix.html#a1ba0cd2a6fa43d69db93a1327e6ce173">fill</a>(3);</div>
<div class="line">    <a class="code" href="class_imagine_1_1_matrix.html">Matrix&lt;T&gt;</a> P(F);                     <span class="comment">// conversion SymMatrix -&gt; Matrix</span></div>
<div class="line">    P=F*G;                              <span class="comment">// symmatrix * symmatrix</span></div>
<div class="line">    P=P*F;                              <span class="comment">// matrix * symmatrix</span></div>
<div class="line">    P=F*P;                              <span class="comment">// symmatrix * matrix</span></div>
<div class="line">    F=F+G;                              <span class="comment">// +</span></div>
<div class="line">    F+=G;                               <span class="comment">// +=</span></div>
<div class="line">    F=F-G;                              <span class="comment">// -</span></div>
<div class="line">    F-=G;                               <span class="comment">// -=</span></div>
<div class="line">    F=F*2;                              <span class="comment">// * scalar</span></div>
<div class="line">    F*=2;                               <span class="comment">// *= scalar</span></div>
<div class="line">    F=2*F;                              <span class="comment">// scalar * SymMatrix</span></div>
<div class="line">    F=F/2;                              <span class="comment">// / scalar</span></div>
<div class="line">    F/=2;                               <span class="comment">// /= scalar</span></div>
<div class="line">    F=-F;                               <span class="comment">// unary -</span></div>
<div class="line">    </div>
<div class="line">    <a class="code" href="class_imagine_1_1_vector.html">Vector&lt;T&gt;</a> b=<a class="code" href="class_imagine_1_1_vector.html">Vector&lt;T&gt;</a>(5).fill(1);   <span class="comment">// Linear solve</span></div>
<div class="line">    <a class="code" href="class_imagine_1_1_vector.html">Vector&lt;T&gt;</a> x=<a class="code" href="group___lin_alg.html#ga067f853c4d1c272d7222d624e8776c2a">linSolve</a>(F,b);</div>
<div class="line">    cout &lt;&lt; norm(F*x-b) &lt;&lt; endl;        <span class="comment">// ...</span></div>
<div class="line">    </div>
<div class="line">    ofstream out(<span class="stringliteral">&quot;tmp.bin&quot;</span>,ios::binary);    <span class="comment">// binary write</span></div>
<div class="line">    F.write(out);                           <span class="comment">// ...</span></div>
<div class="line">    out.close();</div>
<div class="line">    ifstream in(<span class="stringliteral">&quot;tmp.bin&quot;</span>,ios::binary);     <span class="comment">// binary read</span></div>
<div class="line">    F.read(in);                             <span class="comment">// ...</span></div>
<div class="line">    in.close();</div>
<div class="line">    out.open(<span class="stringliteral">&quot;tmp.txt&quot;</span>);                    <span class="comment">// ASCII write</span></div>
<div class="line">    out &lt;&lt; F &lt;&lt; endl;                       <span class="comment">// ...</span></div>
<div class="line">    out.close();</div>
<div class="line">    in.open(<span class="stringliteral">&quot;tmp.txt&quot;</span>);                     <span class="comment">// ASCII read</span></div>
<div class="line">    in &gt;&gt; F;                                <span class="comment">// ...</span></div>
<div class="line">    in.close();</div>
<div class="line">    </div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Functions related to FMatrix in LinAlg</span></div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><span class="keywordtype">void</span> fmatrices() {</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;FMatrix functions&quot;</span> &lt;&lt; endl;</div>
<div class="line">    <a name="_a45"></a><a class="code" href="class_imagine_1_1_f_matrix.html">FMatrix&lt;T,3,4&gt;</a> A( T(1) );</div>
<div class="line">    A(1,1)=A(1,2)=A(2,1)=T(3);</div>
<div class="line">    <a class="code" href="class_imagine_1_1_f_matrix.html">FMatrix&lt;T,3,3&gt;</a> A2=A*<a class="code" href="group___common.html#ga7a6f4637021ea46668612c558b8ace96">transpose</a>(A);</div>
<div class="line">    A2(1,2)=2;</div>
<div class="line">    A2=<a name="a46"></a><a class="code" href="group___lin_alg.html#gadd307f70e80537e42d48c45cd8c80cbc">inverseFMatrix</a>(A2);               <span class="comment">// test fast call to direct inversion</span></div>
<div class="line">    <a class="code" href="class_imagine_1_1_f_matrix.html">FMatrix&lt;T,4,4&gt;</a> A3=<a class="code" href="group___common.html#ga7a6f4637021ea46668612c558b8ace96">transpose</a>(A)*A;</div>
<div class="line">    A3(1,2)=12;A3(1,1)=0;A3(0,0) = 4;</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;A3=&quot;</span> &lt;&lt; A3 &lt;&lt; endl;</div>
<div class="line">    <a class="code" href="class_imagine_1_1_f_matrix.html">FMatrix&lt;T,4,4&gt;</a> A4 = <a class="code" href="group___lin_alg.html#gadd307f70e80537e42d48c45cd8c80cbc">inverseFMatrix</a>(A3);               <span class="comment">// inverse</span></div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;A3*A4=&quot;</span> &lt;&lt; A3*A4 &lt;&lt; endl;</div>
<div class="line"></div>
<div class="line">    <a name="_a47"></a><a class="code" href="class_imagine_1_1_f_vector.html">FVector&lt;T,3&gt;</a> S;                      <span class="comment">// Singular value decomposition:</span></div>
<div class="line">    <a class="code" href="class_imagine_1_1_f_matrix.html">FMatrix&lt;T,3,3&gt;</a> U, Vt;</div>
<div class="line">    <a class="code" href="group___lin_alg.html#gac422594d6d9d59381c93765d1c935d8e">svd</a>(A2,U,S,Vt);                      <span class="comment">// -square</span></div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;SVD check 1: &quot;</span> </div>
<div class="line">         &lt;&lt; norm(A2-U*<a class="code" href="group___common.html#ga62a53c231a09e755f7317b515f968afb">Diagonal</a>(S)*Vt) &lt;&lt; endl;</div>
<div class="line">    <a class="code" href="class_imagine_1_1_f_matrix.html">FMatrix&lt;T,4,4&gt;</a> Vt2;</div>
<div class="line">    <a class="code" href="group___lin_alg.html#gac422594d6d9d59381c93765d1c935d8e">svd</a>(A,U,S,Vt2);                      <span class="comment">// -non square</span></div>
<div class="line">    <a class="code" href="class_imagine_1_1_f_matrix.html">FMatrix&lt;T,3,4&gt;</a> S2(T(0));</div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i &lt; 3; i++)</div>
<div class="line">        S2(i,i) = S[i];</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;SVD check 2: &quot;</span> </div>
<div class="line">         &lt;&lt; norm(A-U*S2*Vt2) &lt;&lt; endl;</div>
<div class="line">    <a class="code" href="group___lin_alg.html#gac422594d6d9d59381c93765d1c935d8e">svd</a>(A,U,S,Vt2,<span class="keyword">true</span>);                 <span class="comment">// non square matrix, complete U and Vt</span></div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;SVD check 3: &quot;</span>              <span class="comment">// Check Vt...</span></div>
<div class="line">         &lt;&lt; norm(Vt2*<a class="code" href="group___common.html#ga7a6f4637021ea46668612c558b8ace96">transpose</a>(Vt2)-<a class="code" href="class_imagine_1_1_f_matrix.html">FMatrix&lt;T,4,4&gt;::Identity</a>()) &lt;&lt; endl;</div>
<div class="line">    </div>
<div class="line">    <a class="code" href="group___common.html#ga22e8edb30a8e0e013e8fe06a26a729e0">initRandom</a>(1);                       <span class="comment">// Linear solve:</span></div>
<div class="line">    <a class="code" href="class_imagine_1_1_f_matrix.html">FMatrix&lt;T,5,5&gt;</a> B;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;5;i++)</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;5;j++)</div>
<div class="line">            B(i,j)=T(<a class="code" href="group___common.html#ga9266b3e5117d08c4b45e60bb7c240b40">doubleRandom</a>());</div>
<div class="line">    <a name="_a48"></a><a class="code" href="class_imagine_1_1_f_vector.html">FVector&lt;T,5&gt;</a> b,x;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;5;j++)</div>
<div class="line">        b[j]=T(<a class="code" href="group___common.html#ga9266b3e5117d08c4b45e60bb7c240b40">doubleRandom</a>());</div>
<div class="line">    x=<a class="code" href="group___lin_alg.html#ga067f853c4d1c272d7222d624e8776c2a">linSolve</a>(B,b);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Square system: &quot;</span> &lt;&lt; norm(B*x-b) &lt;&lt; endl; <span class="comment">// -square</span></div>
<div class="line">    <a class="code" href="class_imagine_1_1_f_matrix.html">FMatrix&lt;T,5,4&gt;</a> C( B.<a name="a49"></a><a class="code" href="class_imagine_1_1_f_matrix.html#a5bab4cddb4300f67146f8ca8c82265b9">data</a>() );</div>
<div class="line">    <a name="_a50"></a><a class="code" href="class_imagine_1_1_f_vector.html">FVector&lt;T,4&gt;</a> x2=<a class="code" href="group___lin_alg.html#ga067f853c4d1c272d7222d624e8776c2a">linSolve</a>(C,b);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Over determined system: &quot;</span> </div>
<div class="line">         &lt;&lt; norm(C*x2-b) &lt;&lt; endl;                   <span class="comment">// -over-determined (min possible but not 0)</span></div>
<div class="line">    <a class="code" href="class_imagine_1_1_f_matrix.html">FMatrix&lt;T,4,5&gt;</a> D( B.<a class="code" href="class_imagine_1_1_f_matrix.html#a5bab4cddb4300f67146f8ca8c82265b9">data</a>() );</div>
<div class="line">    <a class="code" href="class_imagine_1_1_f_vector.html">FVector&lt;T,4&gt;</a> d(b.<a name="a51"></a><a class="code" href="class_imagine_1_1_f_array.html#ab690596932c0fc30e694491333296cb9">data</a>());</div>
<div class="line">    <a class="code" href="class_imagine_1_1_f_vector.html">FVector&lt;T,5&gt;</a> x3=<a class="code" href="group___lin_alg.html#ga067f853c4d1c272d7222d624e8776c2a">linSolve</a>(D,d);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Minimum norm under determined system: &quot;</span> </div>
<div class="line">        &lt;&lt; norm(D*x3-d) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; norm(x3) &lt;&lt; endl; <span class="comment">// -under-determined (min |x| possible but not 0)...</span></div>
<div class="line"></div>
<div class="line">    x=<a class="code" href="group___lin_alg.html#ga0f5fb1fa3fbd6d7cc7988f2e0f87bf99">pseudoInverse</a>(B)*b;                         <span class="comment">// Pseudo-inverse:</span></div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Pseudo inverse, square: &quot;</span> </div>
<div class="line">         &lt;&lt; norm(B*x-b) &lt;&lt; endl;                  <span class="comment">// -square case</span></div>
<div class="line">    x2=<a class="code" href="group___lin_alg.html#ga0f5fb1fa3fbd6d7cc7988f2e0f87bf99">pseudoInverse</a>(C)*b;     </div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Pseudo inverse, over determined: &quot;</span> </div>
<div class="line">         &lt;&lt; norm(C*x2-b) &lt;&lt; endl;                 <span class="comment">// -over determined case</span></div>
<div class="line">    x3=<a class="code" href="group___lin_alg.html#ga0f5fb1fa3fbd6d7cc7988f2e0f87bf99">pseudoInverse</a>(D)*d; <span class="comment">// Erreur quand passage en double</span></div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Pseudo inverse, under determined: &quot;</span> </div>
<div class="line">        &lt;&lt; norm(D*x3-d) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; norm(x3) &lt;&lt; endl; <span class="comment">// -under determined case...</span></div>
<div class="line"></div>
<div class="line">    T tt[]={1,2,3,4,5,6};                           <span class="comment">// pre-allocated</span></div>
<div class="line">    <a class="code" href="class_imagine_1_1_f_matrix.html">FMatrix&lt;T,3,2&gt;</a> D2(tt);      </div>
<div class="line">    <a class="code" href="class_imagine_1_1_f_matrix.html">FMatrix&lt;T,3,2&gt;</a> Q; <a class="code" href="class_imagine_1_1_f_matrix.html">FMatrix&lt;T,2,2&gt;</a> R;             <span class="comment">// QR decomposition:</span></div>
<div class="line">    <a class="code" href="group___lin_alg.html#gab21f09665e8f0a0244f45fb10bf7726e">QR</a>(D2,Q,R);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;QR &quot;</span> &lt;&lt; norm(D2-Q*R) &lt;&lt; endl;          <span class="comment">// -thin QR</span></div>
<div class="line">    <a class="code" href="class_imagine_1_1_f_matrix.html">FMatrix&lt;T,3,3&gt;</a> Q2; <a class="code" href="class_imagine_1_1_f_matrix.html">FMatrix&lt;T,3,2&gt;</a> R2;</div>
<div class="line">    <a name="a52"></a><a class="code" href="group___lin_alg.html#ga55b83f37dcf87fd21623f1ee93a3872b">QRAll</a>(D2,Q2,R2);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;QR &quot;</span> &lt;&lt; norm(D2-Q2*R2) &lt;&lt; endl;        <span class="comment">// -full QR...</span></div>
<div class="line"></div>
<div class="line">    <a class="code" href="class_imagine_1_1_f_matrix.html">FMatrix&lt;T,5,5&gt;</a> E=B*<a class="code" href="group___common.html#ga7a6f4637021ea46668612c558b8ace96">transpose</a>(B);                <span class="comment">// sym pos-def</span></div>
<div class="line">    <a class="code" href="class_imagine_1_1_f_matrix.html">FMatrix&lt;T,5,5&gt;</a> L=<a class="code" href="group___lin_alg.html#ga972b982abc4e29e50c6551578bf2b440">cholesky</a>(E);                   <span class="comment">// Cholesky decomposition:</span></div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Lower Cholesky &quot;</span> </div>
<div class="line">         &lt;&lt; norm(E-L*<a class="code" href="group___common.html#ga7a6f4637021ea46668612c558b8ace96">transpose</a>(L)) &lt;&lt; endl;         <span class="comment">// -lower</span></div>
<div class="line">    <a class="code" href="class_imagine_1_1_f_matrix.html">FMatrix&lt;T,5,5&gt;</a> V=<a class="code" href="group___lin_alg.html#ga972b982abc4e29e50c6551578bf2b440">cholesky</a>(E,<span class="keyword">false</span>);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Upper Cholesky &quot;</span> </div>
<div class="line">         &lt;&lt; norm(E-<a class="code" href="group___common.html#ga7a6f4637021ea46668612c558b8ace96">transpose</a>(V)*V) &lt;&lt; endl;         <span class="comment">// -upper...</span></div>
<div class="line">    </div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Determinants: &quot;</span>     <span class="comment">// Determinant</span></div>
<div class="line">         &lt;&lt; <a name="a53"></a><a class="code" href="group___lin_alg.html#ga0fe7aea233e90d83f75b3bd5564a2f1a">detFMatrix</a>(B)*<a class="code" href="group___lin_alg.html#ga0fe7aea233e90d83f75b3bd5564a2f1a">detFMatrix</a>(<a class="code" href="group___lin_alg.html#gadd307f70e80537e42d48c45cd8c80cbc">inverseFMatrix</a>(B))-1 &lt;&lt; endl;</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Determinants: &quot;</span>                        </div>
<div class="line">         &lt;&lt; <a class="code" href="group___lin_alg.html#ga0fe7aea233e90d83f75b3bd5564a2f1a">detFMatrix</a>(E)*<a class="code" href="group___lin_alg.html#ga0fe7aea233e90d83f75b3bd5564a2f1a">detFMatrix</a>(<a class="code" href="group___lin_alg.html#gadd307f70e80537e42d48c45cd8c80cbc">inverseFMatrix</a>(E))-1 &lt;&lt; endl;</div>
<div class="line">                                 <span class="comment">// Check sym pos-def acceleration...</span></div>
<div class="line"></div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    vectors&lt;float&gt;();</div>
<div class="line">    vectors&lt;double&gt;();</div>
<div class="line">    matrices&lt;float&gt;();</div>
<div class="line">    matrices&lt;double&gt;();</div>
<div class="line">    symMatrices&lt;float&gt;();</div>
<div class="line">    symMatrices&lt;double&gt;();</div>
<div class="line">    fmatrices&lt;float&gt;();</div>
<div class="line">    fmatrices&lt;double&gt;();</div>
<div class="line">    <a name="a54"></a><a class="code" href="group___common.html#ga978318ff6564ae8597ef22dfa9fdc368">waitKey</a>();</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Oct 24 2018 17:05:33 for Imagine++ by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
